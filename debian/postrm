#!/bin/sh

set -e

if [ "$1" = "purge" ]; then
  rm -f /etc/apt-listchanges.conf /etc/apt-listchanges.conf.old \
    /etc/apt/apt.conf.d/20-apt-listchanges.conf \
    /etc/apt/listchanges.conf

  . /usr/share/debconf/confmodule
  db_purge
fi

if [ "$1" = "remove" -o "$1" = "purge" ]; then
    if [ -e /etc/apt/apt.conf ]; then
	cp /etc/apt/apt.conf /etc/apt/apt.conf.old
	(grep -v apt-listchanges /etc/apt/apt.conf.old > /etc/apt/apt.conf) || true
	rm -f /etc/apt/apt.conf.old

	# If we were all that was left, remove apt.conf
	if [ ! -s /etc/apt/apt.conf ]; then
	    rm -f /etc/apt/apt.conf
	    rmdir --ignore-fail-on-non-empty -p /etc/apt/
	fi
    fi
fi

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
